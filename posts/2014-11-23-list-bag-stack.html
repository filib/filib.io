<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Philip is a Ruby and Haskell developer currently working remotely from Melbourne.">
    <title>
      Philip Cunningham -
      
      List, Bag and Stack
      
    </title>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/filib.css">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="column one-third">
          <nav class="masthead">
            <ul>
              <li>
                <a href="../">
                  Home
                </a>
              </li>
              </li>
              <li>
                <a href="../about.html">
                  About
                </a>
              </li>
              <li>
                <a href="../rss.xml">
                  RSS
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
      <hr />
      <div class="row">
        <div>
  <h1>
    List, Bag and Stack
  </h1>
  <section>
    <header>
      <h2>
        2014-11-23
      </h2>
      <p>
        <a href="../tags/haskell.html" class="post-category green">haskell</a>
      </p>
    </header>

    <div>
      <div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">import</span> <span class="dt">Prelude</span> <span class="kw">hiding</span> (map, head, tail, length)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">-- Simple Linked List</span></a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">data</span> <span class="dt">List</span> a <span class="fu">=</span> <span class="dt">Empty</span> <span class="fu">|</span> <span class="dt">Cons</span> a (<span class="dt">List</span> a) <span class="kw">deriving</span> <span class="dt">Show</span></a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="fu">head</span><span class="ot"> ::</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="fu">head</span> (<span class="dt">Cons</span> x xs) <span class="fu">=</span> x</a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="fu">tail</span><span class="ot"> ::</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> <span class="dt">List</span> a</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="fu">tail</span> (<span class="dt">Cons</span> x xs) <span class="fu">=</span> xs</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="ot">cons ::</span> a <span class="ot">-&gt;</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> <span class="dt">List</span> a</a>
<a class="sourceLine" id="cb1-14" title="14">cons x xs <span class="fu">=</span> (<span class="dt">Cons</span> x xs)</a>
<a class="sourceLine" id="cb1-15" title="15"></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="fu">map</span><span class="ot"> ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> <span class="dt">List</span> b</a>
<a class="sourceLine" id="cb1-17" title="17"><span class="fu">map</span> _ <span class="dt">Empty</span>       <span class="fu">=</span> <span class="dt">Empty</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="fu">map</span> f (<span class="dt">Cons</span> x xs) <span class="fu">=</span> cons (f x) (<span class="fu">map</span> f xs)</a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="fu">length</span><span class="ot"> ::</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="fu">length</span> <span class="dt">Empty</span>       <span class="fu">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="fu">length</span> (<span class="dt">Cons</span> x xs) <span class="fu">=</span> <span class="dv">1</span> <span class="fu">+</span> <span class="fu">length</span> xs</a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">List</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-25" title="25">  <span class="fu">fmap</span> <span class="fu">=</span> <span class="fu">map</span></a>
<a class="sourceLine" id="cb1-26" title="26"></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">-- Simple Bag</span></a>
<a class="sourceLine" id="cb1-28" title="28"></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="kw">newtype</span> <span class="dt">Bag</span> a <span class="fu">=</span> <span class="dt">Bag</span> (<span class="dt">List</span> a) <span class="kw">deriving</span> <span class="dt">Show</span></a>
<a class="sourceLine" id="cb1-30" title="30"></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="ot">add ::</span> a <span class="ot">-&gt;</span> <span class="dt">Bag</span> a <span class="ot">-&gt;</span> <span class="dt">Bag</span> a</a>
<a class="sourceLine" id="cb1-32" title="32">add x (<span class="dt">Bag</span> xs) <span class="fu">=</span> <span class="dt">Bag</span> (cons x xs)</a>
<a class="sourceLine" id="cb1-33" title="33"></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="ot">bagSize ::</span> <span class="dt">Bag</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb1-35" title="35">bagSize (<span class="dt">Bag</span> xs) <span class="fu">=</span> <span class="fu">length</span> xs</a>
<a class="sourceLine" id="cb1-36" title="36"></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">Bag</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-38" title="38">  <span class="fu">fmap</span> f (<span class="dt">Bag</span> xs) <span class="fu">=</span> <span class="dt">Bag</span> (<span class="fu">map</span> f xs)</a>
<a class="sourceLine" id="cb1-39" title="39"></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="co">-- Simple Stack</span></a>
<a class="sourceLine" id="cb1-41" title="41"></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="kw">newtype</span> <span class="dt">Stack</span> a <span class="fu">=</span> <span class="dt">Stack</span> (<span class="dt">List</span> a) <span class="kw">deriving</span> <span class="dt">Show</span></a>
<a class="sourceLine" id="cb1-43" title="43"></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="ot">push ::</span> a <span class="ot">-&gt;</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> <span class="dt">Stack</span> a</a>
<a class="sourceLine" id="cb1-45" title="45">push x (<span class="dt">Stack</span> xs) <span class="fu">=</span> <span class="dt">Stack</span> (cons x xs)</a>
<a class="sourceLine" id="cb1-46" title="46"></a>
<a class="sourceLine" id="cb1-47" title="47"><span class="ot">pop ::</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> (a, <span class="dt">Stack</span> a)</a>
<a class="sourceLine" id="cb1-48" title="48">pop (<span class="dt">Stack</span> xs) <span class="fu">=</span> ((<span class="fu">head</span> xs), <span class="dt">Stack</span> (<span class="fu">tail</span> xs))</a>
<a class="sourceLine" id="cb1-49" title="49"></a>
<a class="sourceLine" id="cb1-50" title="50"><span class="ot">peek ::</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb1-51" title="51">peek (<span class="dt">Stack</span> xs) <span class="fu">=</span> <span class="fu">head</span> xs</a>
<a class="sourceLine" id="cb1-52" title="52"></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="ot">stackSize ::</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb1-54" title="54">stackSize (<span class="dt">Stack</span> xs) <span class="fu">=</span> <span class="fu">length</span> xs</a>
<a class="sourceLine" id="cb1-55" title="55"></a>
<a class="sourceLine" id="cb1-56" title="56"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">Stack</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-57" title="57">  <span class="fu">fmap</span> f (<span class="dt">Stack</span> xs) <span class="fu">=</span> <span class="dt">Stack</span> (<span class="fu">map</span> f xs)</a></code></pre></div>
    </div>
  </section>
</div>

      </div>
    </div>
  </body>
</html>
